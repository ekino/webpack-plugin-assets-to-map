language: node_js

node_js:
  "8"

cache:
  yarn: true
  directories:
    - node_modules
    - dist

script:
  - yarn lint
  - yarn test
  - yarn security
  - NODE_ENV=production yarn build

before_deploy: "ls -al dist"

deploy:
  provider: npm
  email: opensource@ekino.com
  skip_cleanup: true
  api_key:
    secure: jLD/0CQw2BTCgsn3eLCfb2XoUiz6l+znpSRSSbl0TQkv5kYlxtuWFB1RHcVV1ZvtuhdTaMqN7HBI96KqDrRlwDf4Kw2Bqx6WJQfUFhyXMhVtOSaeKi9QyX0WwHJ0IqmR3WINKXDf2UX7Q0pxAVocy2LnRVCGuALcpxOt1lkQ6yU/NLTCTLnNRW5hGRLiuPv9+WUS2fuF4mdXpwYRJI7qYnjHc3zkUTnv6FYgpF//hpEPXqdoz1lg4ai1ux36jih4kJlaSGRrlBHRPLnAED9qyDgcJORemJx04DaROqEysiUxlzh+CjR9VyYjmagr9mNgbki81OXISdjDaZvB6fzOlroKUvZ/I9UXdaXO0gJ9fAriHB0gYtEO6v7nobH0Zg6o/ObCVfpSG/rlZHl41apoQktnWehgF9Xn843TDTm9/cyU8h2T8VogcPTwjv0Gosqh6W/HvtdBUr4JplHjRZTRDa57IGHn+lKtWsCnGIthcTg0NrqpT58SqdoBsdBLw++Ubg79cH10TJeA1/4/Msbr5fINn0uywDgxc85nXxacAgFyjOumbR3m5+xb8ig2H5dH4q7XH446gMB723xoohtRAv7NiQKxeCtQorj5gOzX8XlZf+WFbn47eNIlBr9piVL+98WIpvjncexEW7FX9kXnbdvP6W1BNmkdMTHRS/bfpa0=
  on:
    tags: true
    repo: ekino/webpack-plugin-assets-to-map
